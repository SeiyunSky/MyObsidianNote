![[Pasted image 20251014171936.png]]
**计算图用于反向传播**
```python
import torch

x = torch.tensor(1.0, requires_grad=True) #指定需要计算梯度
y = torch.tensor(1.0, requires_grad=True) #指定需要计算梯度
v = 3*x+4*y
u = torch.square(v)
z = torch.log(u)

z.backward() #反向传播求梯度

print("x grad:", x.grad)
print("y grad:", y.grad)
```
定义x，y需要计算梯度
定义计算的流程
PyTorch内部会自动帮我们构建和维护计算图
我们只要调用结果z的反向传播方法
PyTorch内部会根据计算图反向传播，计算梯度。
最终打印出的x和y在（1,1）点的梯度