**前提假设：**
一是基础规则A需具备$((\alpha,f))$- 拜占庭鲁棒性
二是系统中工作机总数需满足$(n \geq 4f + 3)$

**算法过程**：
**首先利用基于任意（a,f)-鲁棒的聚合规则**——Krum
进行n-2f次，直到筛选集规模达到n-2f大小。
**其次对于d个参数维度找均值**，每个维度执行两次快速选择操作，找中位数和中位数坐标值

**命题一（时间复杂度证明）**：
每次聚合为O(n^n\*d + n*d)

**命题二（算法上界证明）：**
**命题2**：用 $B_t$ 表示在第 $t$ 轮由 Bulyan(A) 选出的向量。那么对于任何维度 $i \in [1,d]$ 和任何提交梯度 $g_k$ 的诚实工作者 $k$，我们有： $$E|B_t[i] - g_k[i]| = O\left(\frac{\sigma}{\sqrt{d}}\right)$$**证明思路** 
1. **符号定义**： 
    $\xi = (\xi_1, \cdots, \xi_{n-f})$：诚实工作者使用的随机$(n-f)$ 元组样本
    $\xi_k, k=1 \cdots n-f$：独立同分布 
    $B$：在集合 $M[i]$ 中被 Bulyan(A) 选中的向量 
    $k$：提交梯度 $g_k$ 的诚实工作者 
2. **关键观察**： $B[i]$ 属于最接近 $median[i]$ 的 $\beta$ 个提议值 
   $median[i]$ 是 $\theta \geq 2f+3$ 个提议值的中位数坐标 
   $\beta = \theta - 2f$ 
   整个集合 $M[i]$ 比至少 $2f$ 个其他提议值更接近 $median[i]$ 
3. **存在性保证**： 至少存在两个不同的诚实工作者 $l$ 和 $r$，满足： $$g_l[i] \leq B[i] \leq g_r[i]$$
4. **三种情况分析**： 
   **情况1**：$g_k[i] \in [-\infty, g_l[i]]$，则 $|B[i] - g_k[i]| < |g_l[i] - g_k[i]|$ 
   **情况2**：$g_k[i] \in [g_l[i], g_r[i]]$，则 $|B[i] - g_k[i]| < |g_l[i] - g_r[i]|$ 
   **情况3**：$g_k[i] \in [g_r[i], +\infty]$，则 $|B[i] - g_k[i]| < |g_r[i] - g_k[i]|$ 
5. **数学推导**： 使用指示函数 $I_h$ 表示三种情况 - 得到上界： $$|B[i] - g_k[i]| < I_1|g_l[i] - g_k[i]| + I_2|g_l[i] - g_r[i]| + I_3|g_r[i] - g_k[i]|$$ ![[Pasted image 20251020214814.png|300]]
   ![[Pasted image 20251020214832.png|300]]
   在各个维度独立同分布的情况下，方差对于d个维度来说，有
   ![[Pasted image 20251020215023.png|200]]
   因此带入到原上界中并进行期望分析，就能得到
   ![[Pasted image 20251020215124.png|210]]

**命题2证明了**：Bulyan(A) 减小了攻击者在每个坐标分量上的作恶空间。即使攻击者仍能影响聚合梯度，其在每个坐标分量上所能偏离诚实工作者的程度被限制在 $O\left(\frac{\sigma}{\sqrt{d}}\right)$ 范围内。

**推论一（a，f鲁棒性证明）：**

**诚实节点必然有上界**——
对于 $r \in \{1,2,3,4\}$，存在常数 $A_r, B_r$，使得
$$
\mathbb{E}_\xi\|G(x,\xi)\|^r \leq A_r + B_r\|x\|^r
$$
——**对于 1 到 4 阶的统计矩，诚实工作机计算的梯度，其 “范数的r次方的平均值”（对随机样本求平均），不会无限大 —— 它的上限可以用 “一个固定常数(A_r)” 加上 “另一个固定常数(B_r)乘以参数范数的r次方” 来控制**。
**A是梯度固有的波动上限**
**B是梯度随参数变化的调节系数**

建立在诚实节点必然收敛必然有界的前提下，我们可以运用krum的证明来确保bulyan的SGD收敛性。
而接下来的均值方法，因为不引入无界项，故而必然满足SGD收敛性