#### 核心贡献
1. **识别信息瓶颈**：发现共识达成存在新的信息瓶颈，其特征与通信图的谱隙和Byzantine节点数量相关，且实证表明常见的 Byzantine 鲁棒聚合器在训练中难以达成共识。
2. **提出新攻击方式**：设计DISSENSUS攻击，该攻击针对拓扑结构中的信息瓶颈，放大 worker 间已有的分歧，阻碍模型达成共识。
3. **提出新聚合算法**：提出 Self-Centered Clipping算法，这是首个在标准假设下，能证明对非凸目标收敛到平稳点的$O(\delta_{max}\zeta^{2}/\gamma^{2})$邻域的算法，且实证验证其性能更优。
4. **优化收敛速率**：在研究过程中，还得到了去中心化随机非凸优化的常规（非 Byzantine 场景）最快收敛速率，通过使用局部 worker 动量改进了此前的成果。

#### **问题设定**
**研究目标为一般的分布式优化问题**
$$min_{x\in R^d} f(x):= \frac {1}{|V_R|}\sum _{i \in V_R}\{{f_i(x):=E_{  
ξ_i​∼D_i​​}F_i(x;  ξ_i​)}\}$$
表述为，基于异质数据,整体目标为最小化良性客户端在本地数据分布上损失期望值的最小值。
【这里的$D_i$实际上指的是客户端本地数据所遵循的数据分布，而如果IID，则是使用样本集整体的数据分布$R^d$了】

**$G_R$为连通图**
  相较于前篇研究，去除了对简化图中拜占庭节点数量的要求


**客户端随机梯度与真实平均梯度方差有界性**
$$\mathbb{E}_{\xi \sim \mathcal{D}_{i}}\left\|\nabla F_{i}\left(x ; \xi_{i}\right)-\nabla f_{i}(x)\right\|^{2} \leq \sigma^{2} \quad (2)$$
**客户端与全局梯度差异有界性**
$$\mathbb{E}_{j \sim V_{R}}\left\|\nabla f_{j}(x)-\nabla f(x)\right\|^{2} \leq \zeta^{2} \quad (3)$$

**L-平滑性**

**对称双随机混合矩阵**
工作节点间的通信通过如下混合策略建模
$$x_i^{t+1} = \sum_{j=1}^n W_{ij}x_j^t$$
而对于 $W$ 满足 $$W_{ij} = W_{ji}, \quad \sum_{i=1}^n W_{ij} = 1, \quad \sum_{j=1}^n W_{ij} = 1$$
在训练前确定且全程固定，但仅正常节点间的权重可靠

**有界拜占庭边权重**
  存在 $\delta_{\text{max}} \in [0,1)$，使得对所有 $i \in V_R$，有 $\delta_i \leq \delta_{\text{max}}$。
  
**图参数约束**
$$\| \tilde{W} x - \overline{x} \|_2^2 \leq (1-p) \| x - \overline{x} \|_2^2$$
其中，有$\gamma := 1 - \sqrt{1-p}$

#### 鲁棒去中心化共识
![[Pasted image 20251113144021.png]]![[Pasted image 20251113144028.png]]
考虑无拜占庭节点的场景：若每个工作节点持有向量$x_i$，那么则通过对所有节点进行$$  
x_i^{t+1}​:=∑_{j=1}^n​W_{ij}​x_j^t​$$
最终所有节点基于上述假设能够收敛到共识。

#### 分歧攻击
在聚合过程中，发送与正常邻居更新方向相反的信息。
$$x_j := x_i - \varepsilon_i \cdot \frac{\sum_{k \in N_i \cap V_R} W_{ik} (x_k - x_i)}{\sum_{j \in N_i \cap V_B} W_{ij}} \tag{8}$$
在全连接拓扑下分期攻击无法生效，因为其对称性会导致所有扰动项相互抵消。
![[Pasted image 20251108162537.png|460]]
其中，

| 参数符号        | 参数名称              |
| ----------- | ----------------- |
| G=(V,E)     | 通信图               |
| $V_R$​      | 正则（良性）工作节点集合      |
| $V_B$​      | 拜占庭（恶意）工作节点集合     |
| $G_R$​      | 由正则节点诱导的子图        |
| $N_i$​      | 节点 i的邻居集合         |
| $N_i$​      | 节点 i的封闭邻居集合（包含自身） |
| $W∈R_{n×n}$ | 混合矩阵              |
| $δ_i$​      | 节点 i连接的拜占庭边权重总和   |
| $δ_{max}$​  | 最大局部拜占庭权重         |
| W           | 正则子图上的等效混合矩阵      |
| γ           | 通信图的谱间隙           |
| p           | 图参数（与谱间隙相关）       |
| $f(x)$      | 全局优化目标函数          |
| $f_i​(x)$   | 工作节点 i的本地目标函数     |
| $D_i$​      | 工作节点 i上的数据分布      |
| $σ^2$       | 随机梯度方差            |
| $ζ^2$       | 数据异构性上界           |
| $L$         | 函数光滑性常数（利普希茨常数）   |
| $x_i^t$​    | 工作节点 i在时间 t的模型状态  |
| $η$         | 学习率               |
| $α$         | 动量系数              |
| $τ_i$​      | 节点 i的裁剪半径         |
| $ε_i$​      | DISSENSUS 攻击强度参数  |
![[Pasted image 20251108162935.png|400]]
![[Pasted image 20251113150510.png]]
#### **关键引理**
**虚拟迭代更新规则**
剪裁与拜占庭攻击对实际更新过程的影响
$$\Delta^{t+1} := \frac{1}{|V_R|} \sum_{i \in V_R} \left( \sum_{j \in V_R} W_{ij} (z_{j \to i}^{t+1} - x_j^{t+1/2}) + \sum_{j \in V_B} W_{ij} (z_{j \to i}^{t+1} - x_i^{t+1/2}) \right)$$
$$x^{t+1}=x^t−ηm^{t+1}+Δ^{t+1}$$

**充分下降引理**
作为分析基础——将问题转化为如何分析动量误差和裁剪误差带来的影响
$$\mathbb{E}f\left(\overline{x}^{t+1}\right) \leq f\left(\overline{x}^{t}\right)-\frac{\eta}{2}\left\|\nabla f\left(\overline{x}^{t}\right)\right\|_{2}^{2}-\frac{\eta}{4} \mathbb{E}\left\|\overline{m}^{t+1}-\frac{1}{\eta} \Delta^{t+1}\right\|_{2}^{2}+\eta e_{1}^{t+1}+\frac{1}{\eta} e_{2}^{t+1}$$

![[Pasted image 20251113160149.png]]
**引理8则是分析了本地向量更新过程引入动量的作用**
进而为上式提供了动量带来的误差上界
![[Pasted image 20251108165405.png]]

**裁剪误差的上界**
若裁剪半径$$\tau_i^{t+1} = \sqrt{\frac{1}{\delta_i} \sum_{j \in V_R} W_{ij} \mathbb{E} \| x_i^{t+1/2} - x_j^{t+1/2} \|_2^2}$$，则：$$e_2^{t+1} \leq 32 \delta_{max} \left( 2\eta^2 (e_I^{t+1} + \zeta^2) + \Xi^t \right)$$


![[Pasted image 20251108170940.png]]

| 类别          | 具体内容                                                                                                                            |
| ----------- | ------------------------------------------------------------------------------------------------------------------------------- |
| 核心收敛项       | $$O\left(\frac{\delta_{max} \zeta^2}{\gamma^2}\right)$$（主导项）                                                                    |
| 噪声相关高阶项     | $$2\left(\frac{3^2}{\|V_R\|} + \frac{320^2}{\gamma^2} \delta_{max}\right)^{1/2}\left(\frac{3L \sigma^2 r_0}{T+1}\right)^{1/2}$$ |
| 异质性相关高阶项    | $$2\left(\frac{200}{\gamma^2} \zeta^2\right)^{1/3}\left(\frac{r_0 L}{T+1}\right)^{2/3}$$                                        |
| 噪声相关高阶项（四阶） | $$2\left(\frac{600}{\gamma^2} \sigma^2\right)^{1/4}\left(\frac{r_0 L}{T+1}\right)^{3/4}$$                                       |
| 初始次优性残留项    | $$\frac{d_0 r_0}{T+1}$$（$$d_0 = \frac{40L}{\gamma}$$）                                                                           |
| 关键算法参数      | 学习率$$\eta \leq \frac{\gamma}{40L}$$、动量参数$$\alpha = 3\eta L$$                                                                    |
| 约束条件        | $$\delta_{max} \leq \frac{\gamma^2}{10 \cdot 2^{10}}$$                                                                          |
