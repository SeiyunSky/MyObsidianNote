​**​提交截止时间​**​：2025年8月13日23:55（北京时间）

​**​版本​**​：1.1（2025年7月15日更新）

### 作业目标

本作业将通过Jupyter Notebook形式评估您对以下模块内容的理解：

1. 文档聚类
    
2. 感知机
    
3. 神经网络
    
4. 无监督学习
    
    （涵盖模块4和模块5的内容）
    

在Jupyter Notebook中，您可以自由使用numpy、scipy、matplotlib和scikit-learn库中的任何导入，但禁止使用那些会使题目变得过于简单的导入（问题3除外，该题允许基于实验课代码导入pytorch）。本作业满分100分（各部分分数总和），占本课程最终成绩的16%。请务必仔细阅读并理解所有任务要求以及文档末尾关于提交、评分标准和处罚的说明。祝您顺利完成作业！

### 1 文档聚类

​**​背景​**​：本部分要求使用无监督学习算法（基于期望最大化算法的混合模型）解决文档聚类问题。我们遵循模块4中的符号表示：设D={d₁,d₂,...,d_N}为包含N个文档的集合，需将其划分为K个簇。请使用参数φ_k表示第k个簇的先验概率，μ_wk表示第k个簇中第w个词的出现概率。所有文档共享相同的词汇表A。

#### 问题1 [期望最大化算法，8+4+2+10+8+8=40分]

I 请简要回答以下高层次问题：

- 分别写出完整数据和不完整数据情况下文档聚类模型的最大似然估计(MLE)的数学表达式，并简要说明为什么含不完整数据的MLE难以优化。
    
- 简要解释EM算法用于寻找MLE参数估计的核心思想。
    

II 推导文档聚类的(软)EM算法的期望步骤(E-step)和最大化步骤(M-step)，在Markdown单元格中展示（建议使用LaTeX进行规范排版，以便在提交的PDF报告中清晰呈现）。特别需要包含所有需要学习的模型参数，以及学习过程中更新这些参数的具体表达式（即E-step、M-step和分配步骤，使用与模块4相同的数学约定）。

III 加载Task2A.txt文件（如需预处理，请参考活动4.2中的文本处理方法）。

IV 实现模块4第5章推导的EM算法。请在提交的代码中添加充分注释。

提示：

a) 如有需要，可基于活动4.1中提供的高斯混合模型(GMM)EM算法代码进行开发。但请注意，EM算法不仅限于解决GMM问题，请根据课程内容评估并选择适合当前需求的模型。

b) 实现M-step时，需要对后验概率矩阵进行行归一化。具体而言，若要对一个包含对数概率的N维向量x_i=log p_i进行softmax归一化，我们可能会直接计算以下公式：

pi​=∑n=1N​exp(xn​)exp(xi​)​,n=1∑N​pn​=1(1)

由于每个x_i都是对数概率，其数值可能极大且可正可负，直接取指数可能导致下溢或上溢（例如exp(10000)=inf）。此时可使用log-sum-exp技巧来避免数值不稳定问题。log-sum-exp运算定义如下：

LSE(x1​,…,xN​)=log(n=1∑N​exp(xn​)),(2)

=c+log(n=1∑N​exp(xn​−c)),(3)

通常取c=max{x₁,...,x_N}确保最大的指数项为exp(0)=1，这样既能避免上溢，即使发生下溢也能得到合理结果。最终计算公式为：

pi​=exp(xi​−c−log(n=1∑N​exp(xn​−c))).(4)

在实现过程中必须使用此log-sum-exp技巧。

V 设置簇数K=4，分别使用硬EM（硬聚类）和软EM（软聚类）对给定数据进行聚类。

VI 参考活动4.2的方法，对混合模型得到的聚类结果进行PCA分析。然后以前两个主成分为坐标轴，用不同颜色绘制各簇数据点（类似活动4.2的呈现方式）。基于绘图结果，在Markdown单元格中分析讨论硬聚类与软聚类的区别及其原因。

### 2 感知机 vs 神经网络

​**​背景​**​：本部分将在给定的合成数据集上进行二分类任务，使用感知机和3层神经网络等机器学习工具。我们重点关注您对感知机与神经网络差异的有意义观察和讨论。

#### 问题2 [神经网络决策边界，2+7+10+6=25分]

I 加载Task2B_train.csv和Task2B_test.csv数据集，分别绘制训练数据和测试数据的散点图，并用不同颜色标注不同类别的数据点。

II 在训练数据上训练两个感知机模型，分别设置学习率η为0.1和1.0。计算两个模型的测试误差，选择表现更优的η值及其对应模型，然后在一个图中同时绘制决策边界和测试数据。

提示：我们期望感知机的决策边界是一个将测试数据分为两部分的线性函数。为方便起见，您可以选择将标签从[0,1]转换为[-1,+1]。

III 对隐藏层单元数K∈{5,10,15,...,40}（从5到40，步长5）和学习率η∈{0.01,0.001}的每种组合，训练3层神经网络并记录测试误差。绘制不同K值对测试数据准确率的影响曲线。基于该曲线确定最优的K和η组合，获得最佳模型后，在一个图中同时绘制决策边界和测试数据。

IV 对比步骤II和III生成的绘图，解释感知机与3层神经网络性能差异的原因。

提示：观察绘图结果并思考模型假设的差异。

### 3 无监督学习

​**​背景​**​：本部分将实现基于自编码器和3层神经网络的自学习(self-taught learning)方法，解决真实数据的多分类任务。

#### 问题3 [自监督神经网络学习，2+8+2+8+8+7=35分]

I 加载Task2C_labeled.csv（有标签数据）、Task2C_unlabeled.csv（无标签数据）和Task2C_test.csv（测试数据）数据集，并导入必要的库。注意：我们将同时使用Task2C_labeled.csv和Task2C_unlabeled.csv训练自编码器，但仅使用Task2C_labeled.csv训练分类器。最终在测试集Task2C_test.csv上评估分类器性能。

II 训练仅含单隐藏层的自编码器，调整其隐藏层神经元数量为20,60,100,...,220（从20到220，步长40）。

III 对步骤II中的每个自编码器模型，计算并记录重构误差（即自编码器输入与输出的欧氏距离平均值）。绘制隐藏层神经元数量（x轴）与重构误差（y轴）的关系曲线，然后基于该曲线解释您的发现。

IV 使用训练集的原始特征构建3层神经网络分类模型，调整隐藏层神经元数量为20,60,100,...,220（从20到220，步长40）。对每个模型计算并记录测试误差。

V 基于步骤II训练的自编码器模型构建增强的自学习网络。对每个模型：

1. 将自编码器隐藏层的输出作为额外特征，扩充原始特征集；
    
2. 使用所有特征（原始+新增）训练新的3层神经网络，同样调整隐藏层神经元数量（同步骤IV）；
    
3. 计算并记录测试误差。
    
    例如，各模型构建方式如下：
    
    模型1：20隐藏神经元+20个自编码器新增特征
    
    模型2：60隐藏神经元+60个自编码器新增特征
    
    ...
    
    模型5：220隐藏神经元+220个自编码器新增特征
    

VI 绘制步骤IV（基础3层神经网络）和步骤V（增强自学习网络）的测试误差曲线，x轴为隐藏神经元数量，y轴为分类错误率。基于曲线图解释3层神经网络与增强自学习网络的性能差异（或相似性）及其原因。

### 提交要求

作业通过Moodle系统提交文件进行评估。未提交文件者作业得0分。

​**​提交说明​**​：

请提交一个符合命名规范的ZIP压缩包：学号_名字_姓氏_assignment2.zip，其中包含：

- 三个作业部分的Jupyter Notebook文件（.ipynb）及其PDF导出文件
    
- 共6个文件，命名格式示例：
    
    学号_名字_姓氏_a2_sec1.ipynb
    
    学号_名字_姓氏_a2_sec1.pdf
    
    学号_名字_姓氏_a2_sec2.ipynb
    
    学号_名字_姓氏_a2_sec2.pdf
    
    （以此类推）
    

​**​Notebook内容要求​**​：

每个问题的Notebook必须包含：

1. 开头的Markdown单元格注明姓名和学号
    
2. 清晰的问题分节结构（使用Markdown标题和子标题）
    
3. 每个问题包含：
    
    - 所有要求的代码
        
    - 所有要求的图表
        
    - 需要文字回答的问题答案（写在Markdown单元格中）
        

注：根据系统差异，可能需要先导出HTML文件，再用浏览器另存为PDF。所有提交必须在本文档开头指定的截止时间前通过Moodle完成。

​**​重要提示​**​：

1. 延迟1秒即视为延迟1天（扣5%），建议考虑网络延迟提前提交，勿卡截止时间。
    
2. 不接受重新提交，请务必在提交前仔细检查作业内容。
    

### 评分标准

作业最终成绩为各部分得分总和。提交的Notebook将根据以下标准评估：

1. 代码功能：代码可正常运行且结果正确
    
2. 代码可读性：使用清晰的编程范式、函数/变量命名，关键位置添加注释
    
3. 文字回答质量：论证完整性和逻辑性、专业术语使用规范、引用外部来源时注明
    
4. 若因包含无关冗余信息导致关键信息难以获取，可能会扣分。
    
    （注：每位作业的评分时间有限。若评分者无法在时间内理解您的提交内容，将可能扣分。）
    

### 处罚条款

- 迟交处罚：截止时间后提交者，每天扣5%分数；迟交超过7天者该作业得0分
    
- 文件命名不规范：扣5%
    
- Jupyter Notebook缺乏结构（如未用标题分节）：扣5%
    

​**​评估影响说明​**​：

面试是作业2评估的关键环节。若学生未能在面试中展示对作业的充分理解，无论提交作业质量如何，作业2成绩都将记为0分。通过面试者，其作业将按常规评分标准评估并确认最终成绩。

请通过以下方面充分准备面试：

- 仔细检查代码实现
    
- 练习技术解释
    
- 确保能清晰阐述代码和非代码问题背后的技术概念